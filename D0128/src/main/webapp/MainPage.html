<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Main Page</title>
    <link rel="stylesheet" href="css/MainPage.css" />

    <script src="js/jquery-3.6.0.min.js"></script>	
	<script src="js/core.js"></script>
	</head>
  <body>
    <div class="header">
      <h1>MOLE</h1>
    </div>

    <div class="main-container">
      <div class="ongoing-projects">
        <h2>On Going</h2>
        <div class="project-list"></div>
      </div>
      <div>
        <div class="recent-and-gantt">
          <div class="box-col">
            <h2 class="title">recent issue</h2>
            <div class="recent-issue-container">
              <div class="recent-issues">
                <div class="issue">issue: something on svelte</div>
                <div class="issue">issue: something on svelte</div>
                <div class="issue">issue: something on svelte</div>
              </div>
            </div>
          </div>

          <div class="box-col">
            <h2 class="title">Gantt Chart</h2>
            <div class="gantt-chart-container">
              <div class="chart">
                <div>Example Block A</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
<script>
  $(document).ready(function () {
    loadProjects(); // í˜ì´ì§€ ë¡œë“œ ì‹œ í”„ë¡œì íŠ¸ ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸°
  });
  function loadProjects() {
	    $.ajax({
	        url: "jsp/GetProjectList.jsp",
	        type: "GET",
	        dataType: "json",
	        cache: false, // âœ… ìµœì‹  ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ë„ë¡ ì„¤ì •
	        success: function (projects) {
	            console.log("âœ… í”„ë¡œì íŠ¸ ë°ì´í„° ìˆ˜ì‹ :", projects);
	            if (projects.length === 0) {
	                console.warn("âš  ì„œë²„ì—ì„œ í”„ë¡œì íŠ¸ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.");
	            }
	            showProjects(projects);
	        },
	        error: function (xhr, status, error) {
	            console.error("âŒ AJAX ì˜¤ë¥˜ ë°œìƒ:", error);
	        },
	    });
	}




  function showProjects(projects) {
    var projectContainer = $(".project-list");
    projectContainer.empty(); // ê¸°ì¡´ ë¦¬ìŠ¤íŠ¸ ì´ˆê¸°í™”

    if (projects.length > 0) {
      for (var i = 0; i < projects.length; i++) {
        projectContainer.append(getProjectCode(projects[i])); // í”„ë¡œì íŠ¸ UI ìƒì„±
      }
    } else {
      projectContainer.append("<p>No On Going Projects</p>"); // ë°ì´í„° ì—†ì„ ë•Œ ë©”ì‹œì§€ í‘œì‹œ
    }
  }

  function getProjectCode(project) {
	    return `
	        <div class="project">
	            <h3>${project.name}</h3>
	            <p>ğŸ“… Created At: ${project.created_at}</p>
	        </div>
	    `;
	}

</script>
