<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MOLE - Gantt Chart</title>
    <link rel="stylesheet" href="css/TeamPage.css">
    <script src="js/jquery-3.6.0.min.js"></script>
</head>
<body>

    <!-- üìå ÏÉÅÎã®Î∞î -->
    <div class="header">
        <h1>MOLE</h1>
    </div>

    <div class="container">
        <!-- üìå ÏôºÏ™Ω ÏÇ¨Ïù¥ÎìúÎ∞î -->
        <div class="sidebar">
            <ul>
                <li class="sidebar-link" data-link="MainPage.html">ÎåÄÏãúÎ≥¥Îìú</li>
                <li class="sidebar-link" data-link="GanttChart.html">Í∞ÑÌä∏Ï∞®Ìä∏</li>
                <li class="sidebar-link" data-link="IssuePage.html">Issue</li>
                <li class="sidebar-link" data-link="TeamPage.html">TeamBoard</li>
            </ul>
        </div>

        <!-- üìå Î©îÏù∏ Ïª®ÌÖêÏ∏† (Í∞ÑÌä∏Ï∞®Ìä∏) -->
        <div class="main-content">
            <h2>Gantt Chart</h2>
            <div class="gantt-chart-container">
                <div class="gantt-chart">
                    <div class="gantt-header">
                        <div class="gantt-project-name">Project</div>
                        <div class="gantt-days">
                            <div>Ïõî</div>
                            <div>Ìôî</div>
                            <div>Ïàò</div>
                            <div>Î™©</div>
                            <div>Í∏à</div>
                        </div>
                    </div>
                    <div class="gantt-body" id="ganttBody">
                        <!-- JavaScriptÎ°ú ÌîÑÎ°úÏ†ùÌä∏ÏôÄ ÏßÑÌñâÎèÑÎ•º ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞Ä -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- üìå ÌîÑÎ°úÌïÑ Î©îÎâ¥ (Ïò§Î•∏Ï™Ω ÌïòÎã® ÏúÑÏπò) -->
    <div class="profile-container">
        <img src="public/logo-transparent.png" alt="MOLE PMS Logo" class="profile-btn" id="profileBtn">
        <div class="profile-menu" id="profileMenu">
            <ul>
				<li data-link="MainPage.html">Ìôà</li>
                <li data-link="TeamPage.html">ÌåÄ ÌéòÏù¥ÏßÄ</li> <!-- ‚úÖ ÌåÄ ÌéòÏù¥ÏßÄ Ï∂îÍ∞Ä -->
                <li data-link="FindTeam.html">ÌåÄ Ï∞æÍ∏∞</li>
                <li data-link="CreateTeam.html">ÌåÄ ÎßåÎì§Í∏∞</li>
                <li data-link="TeamManage.html">ÌåÄ Í¥ÄÎ¶¨</li>
                <li data-link="ProfilePage.html">ÌîÑÎ°úÌïÑ</li>
                <li data-link="SettingsPage.html">ÏÑ§Ï†ï</li> </ul>
        </div>
    </div>

    <script>
    $(document).ready(function () {
        // üìå ÏÇ¨Ïù¥ÎìúÎ∞î Î∞è ÌîÑÎ°úÌïÑ Î©îÎâ¥ ÌÅ¥Î¶≠ Ïãú ÌéòÏù¥ÏßÄ Ïù¥Îèô
        $(".sidebar-link, .profile-menu li").on("click", function () {
            const targetPage = $(this).data("link");
            window.location.href = targetPage;
        });

        // üìå ÌîÑÎ°úÌïÑ Î≤ÑÌäº ÌÅ¥Î¶≠ Ïãú Î©îÎâ¥ ÌÜ†Í∏Ä
        const profileBtn = $("#profileBtn");
        const profileMenu = $("#profileMenu");

        profileBtn.on("click", function (event) {
            event.stopPropagation();
            profileMenu.toggleClass("active");
        });

        $(document).on("click", function (event) {
            if (!profileBtn.is(event.target) && !profileMenu.is(event.target) && profileMenu.has(event.target).length === 0) {
                profileMenu.removeClass("active");
            }
        });

        // üìå Í∞ÑÌä∏ Ï∞®Ìä∏ Îç∞Ïù¥ÌÑ∞ Î∂àÎü¨Ïò§Í∏∞
        loadGanttChart();

        function loadGanttChart() {
            $.ajax({
                url: "jsp/GetProjectList.jsp",
                type: "GET",
                dataType: "json",
                success: function (projects) {
                    console.log("‚úÖ Í∞ÑÌä∏ Ï∞®Ìä∏ Îç∞Ïù¥ÌÑ∞ ÏàòÏã†:", projects);
                    renderGanttChart(projects);
                },
                error: function (xhr, status, error) {
                    console.error("‚ùå Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ïò§Î•ò:", error);
                }
            });
        }

        // üìå Í∞ÑÌä∏ Ï∞®Ìä∏ Î†åÎçîÎßÅ Ìï®Ïàò
        function renderGanttChart(projects) {
            const ganttBody = $("#ganttBody");
            ganttBody.empty();

            projects.forEach(project => {
                const row = `
                    <div class="gantt-row">
                        <div class="project-name">${project.name}</div>
                        <div class="gantt-progress">
                            <div class="${project.schedule[0] ? 'active' : ''}"></div>
                            <div class="${project.schedule[4] ? 'active' : ''}"></div>
                            <div class="${project.schedule[1] ? 'active' : ''}"></div>
                            <div class="${project.schedule[2] ? 'active' : ''}"></div>
                            <div class="${project.schedule[3] ? 'active' : ''}"></div>
                        </div>
                    </div>
                `;
                ganttBody.append(row);
            });
        }
    });
    </script>

</body>
</html>
